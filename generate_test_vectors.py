
from random import randint
from ntt import NTT
from poly import Poly
from test_cases import TEST_CASES

file = open("test_vectors.py", "w")
file.write("# File generated with `python generate_test_vectors.py`.\n")
file.write(
    "# Test vectors for f, g, ntt(f), ntt(g), ntt(f)*ntt(g), and f*g.\n"
)
file.write("f = dict()\n")
file.write("g = dict()\n")
file.write("f_ntt = dict()\n")
file.write("g_ntt = dict()\n")
file.write("f_ntt_mul_g_ntt = dict()\n")
file.write("f_mul_g = dict()\n\n")


for (q, two_adicity) in TEST_CASES:
    n = 1 << (two_adicity-1)
    # f = [randint(0, q-1) for _ in range(n)]
    # g = [randint(0, q-1) for _ in range(n)]
    if q == 3329:
        f = [2011, 3045, 818, 251, 2602, 3298, 782, 2838, 1418, 743, 905, 3135, 956, 1294, 3021, 2048, 2105, 2676, 1611, 103, 1043, 385, 1686, 239, 2586, 2797, 358, 3002, 2092, 2098, 1276, 520, 2115, 993, 1440, 215, 3129, 2564, 347, 325, 2283, 549, 1323, 809, 522, 2276, 1085, 3217, 2914, 2021, 3157, 559, 1275, 606, 1099, 402, 2216, 1550, 755, 1858, 1755, 2697, 881, 1204,
             1788, 1084, 1731, 780, 420, 3073, 2281, 1067, 788, 1935, 2777, 1810, 1147, 984, 1009, 329, 3235, 1434, 1946, 2517, 12, 2359, 1868, 1231, 2747, 1919, 2690, 2373, 2645, 2243, 2725, 1441, 1824, 2286, 2852, 485, 1196, 1488, 2428, 1286, 296, 2882, 1503, 2251, 40, 2189, 2890, 1481, 1612, 2074, 2949, 2054, 998, 2343, 2479, 2554, 1097, 982, 799, 401, 2329, 1032, 2064, 658]
        g = [2112, 1725, 1718, 1334, 2640, 1229, 1082, 2753, 3317, 32, 1354, 1742, 2413, 2118, 2280, 2699, 1571, 3096, 607, 1411, 2196, 2537, 1866, 2861, 2004, 1181, 409, 2849, 1175, 652, 2158, 2641, 2231, 1655, 682, 509, 654, 1326, 2297, 90, 273, 3225, 1086, 1548, 2333, 3053, 2530, 1636, 809, 1493, 563, 607, 2721, 1392, 2017, 440, 2000, 85, 656, 2821, 1678, 38, 2664, 275,
             1148, 2696, 1117, 2617, 2445, 2083, 3198, 1002, 927, 832, 22, 706, 2237, 3290, 458, 2710, 2067, 2460, 246, 637, 2048, 1477, 2920, 221, 556, 2039, 1746, 3142, 1385, 1769, 787, 1000, 455, 2665, 774, 2751, 1835, 29, 3142, 2076, 3033, 2195, 104, 290, 1326, 3050, 873, 1517, 2388, 1092, 1677, 3153, 2069, 2880, 2491, 1814, 1717, 2289, 336, 1419, 1651, 1651, 2905, 2443]
    elif q == 12289:
        f = [11509, 7877, 1397, 4998, 80, 9102, 4762, 3783, 1965, 12188, 5507, 1945, 6846, 11815, 6564, 5515, 12174, 3774, 12027, 2856, 429, 2080, 6860, 6957, 1824, 913, 603, 3407, 7675, 6083, 11213, 7311, 5764, 5867, 8759, 2381, 8892, 7198, 10758, 11834, 5255, 9443, 11056, 11243, 10123, 6527, 8148, 7028, 3519, 4286, 11293, 11891, 5928, 10430, 12089, 10349, 8027, 5068, 7477, 2745, 967, 7677, 3052, 246, 9663, 9948, 992, 4950, 8772, 5345, 4139, 4257, 4123, 11703, 666, 11628, 7226, 3523, 4749, 1533, 11116, 9764, 6353, 7786, 8285, 8866, 1772, 3363, 161, 2483, 5782, 6310, 341, 2501, 4827, 9327, 11556, 1624, 2139, 10322, 1216, 7947, 978, 3689, 9750, 10687, 4149, 3604, 9844, 7546, 2549, 1222, 9690, 2637, 10911, 9535, 888, 11778, 9251, 3682, 3166, 1481, 5364, 7042, 2298, 1442, 1262, 4496, 883, 11552, 7247, 2160, 1865, 10646, 12092, 512, 11367, 5350, 9499, 6942, 4876, 1734, 7220, 5276, 7259, 3537, 11884, 9065, 6950, 6109, 7865, 9598, 1964, 2894, 9199, 4626, 6831, 1227, 3590, 9269, 11011, 8203, 11430, 8148, 3112, 2505, 7477, 2408, 1852, 12260, 10013, 4770, 10225, 6091, 4951, 11905, 7516, 5026, 5946, 1972, 7604, 11566, 12019, 6334, 2478, 1557, 7665, 1040, 8281, 1124, 3279, 5155, 10295, 6128, 4913, 5102, 3612, 2554, 11304, 11632, 3900, 2178, 12161, 9031, 1752, 6535, 165, 9446, 2392, 353, 1531, 10445, 4080, 3934, 193, 5802, 5852, 9205, 2625, 10363, 2203, 11845, 11242, 4049, 8996, 4101, 2910, 473, 9640, 7800, 9801, 12109, 2145, 6856, 3230, 4698, 104, 1074, 7647, 7284, 2208, 10569, 4808, 1552, 7457, 10325, 5767, 11313, 5837, 8433, 11829, 1965, 5525, 8605, 10519, 2704, 2694, 6629, 873, 11608, 9872, 10683, 1390, 9270, 6349, 10567, 3285, 11504, 5767, 6186, 10841, 6592, 10032, 11603, 6318, 8037, 11, 6762, 11967, 6240, 10288, 9727, 9006, 4123, 6418, 10062, 43, 3274, 7080, 10524, 11688, 6299, 538, 9090, 5882, 2451, 708, 6535, 8761, 8123, 8326, 7182, 2882, 2113, 10812, 8611, 11945, 2923, 657, 6305, 7091, 3014, 7857, 2985, 879, 5933, 1103, 3592, 5223, 3328, 8078, 3682, 7553, 8723, 9345, 9597, 3962, 2614, 11569, 4374, 966, 5628, 9650, 8363, 4607, 914, 8661, 9915, 9609, 1562, 3739, 8766, 10186, 5930, 10544, 9236, 2684, 3929, 2619, 4427, 11095, 10991, 9100, 1736, 11813, 2117, 9012, 2089, 871, 6589, 7517, 5686, 3612, 11345, 9345, 5333, 4015, 4853, 1352, 6377, 10564, 6298, 8637, 7276, 11072, 5236, 10139, 10731, 9881, 7742, 2479, 10336, 6291, 5368, 9140, 12058, 2272, 5674, 2616, 10046, 7480, 6221, 12284, 12196, 3664, 543, 9248, 2067, 6839, 4505, 6012, 1278, 8536, 1003, 10104, 11840, 11501, 3738, 6278, 4473, 8891, 6150, 4311, 3716, 6423, 9263, 3504, 958, 306, 6626, 2864, 2316, 8175, 8229, 11002, 5148, 8358, 4292, 4793, 7257, 9203, 8689, 4394, 796, 9754, 6119, 11901, 8018, 9944, 331, 9862, 6323, 5687, 4222, 1482, 6854, 7563, 1938, 425, 5467, 12004, 10680, 9308, 6877, 8791, 8368, 9708, 3208, 6066, 10725, 1217, 2374, 373, 3990, 7457, 2866, 2247, 11860, 11484, 6529, 3717, 6743, 7137, 11902, 711, 2082, 7510, 10788, 5957, 7516, 2761, 698, 7172, 8405, 4851, 7390, 1027, 5714, 7001, 3583, 6833, 1147, 6781, 8412, 3476, 1850, 11160, 5737, 10712, 5015, 8527, 1415, 8723, 8534, 10809, 11281, 10526, 8763, 9032, 962, 12114,
             5599, 2571, 7974, 5988, 3397, 2796, 5263, 11870, 9181, 264, 10993, 843, 5315, 4204, 5247, 12076, 7284, 10012, 9671, 8362, 2572, 6862, 4779, 3482, 3649, 8735, 8094, 5085, 2632, 3146, 7223, 9455, 372, 2224, 9896, 4584, 3974, 9044, 9531, 10488, 6301, 2601, 222, 10625, 10756, 7039, 7387, 4275, 2670, 3807, 5553, 1860, 8171, 10488, 2305, 10096, 5339, 8300, 7766, 4102, 10830, 1204, 2669, 4793, 7550, 8964, 7387, 4274, 3547, 9070, 993, 12123, 4141, 10816, 489, 7680, 9320, 12216, 6734, 3824, 4368, 7548, 9629, 6970, 2763, 11692, 5402, 6655, 653, 1269, 9558, 6456, 5417, 3671, 7113, 7608, 2790, 8323, 5244, 8298, 4085, 7696, 12029, 4669, 8215, 4425, 96, 10955, 3412, 11739, 8599, 1487, 11866, 3389, 3475, 4649, 5459, 7729, 4458, 8086, 2056, 7855, 333, 6011, 10453, 936, 10742, 2246, 8325, 4736, 7310, 674, 3923, 5971, 11311, 6282, 1835, 17, 3746, 8509, 2740, 7487, 11679, 4834, 11390, 9322, 7492, 4247, 979, 7346, 8424, 6685, 2085, 10811, 3566, 3687, 3818, 9215, 8448, 10356, 11542, 4145, 3077, 413, 10408, 4899, 11481, 3055, 4263, 8906, 6495, 10446, 918, 81, 4403, 83, 5228, 1302, 6612, 8796, 12215, 6458, 2226, 9466, 7585, 11754, 7896, 2597, 10785, 11045, 9600, 7687, 1155, 11199, 4342, 5063, 7072, 5584, 5929, 4747, 6976, 7231, 5712, 8385, 2409, 1993, 6380, 11215, 1217, 6232, 699, 9441, 7601, 8919, 4903, 5655, 4778, 2842, 5776, 5547, 5619, 10189, 2293, 11749, 9083, 2853, 9264, 5171, 3701, 8220, 9221, 11047, 7898, 3185, 10856, 8682, 8842, 20, 7241, 5460, 5482, 2046, 2228, 7352, 5537, 8422, 1527, 3139, 11958, 990, 4091, 12001, 374, 10646, 3852, 3034, 282, 7138, 4674, 8916, 11818, 5385, 4851, 4640, 6788, 1627, 11023, 7004, 919, 6717, 7784, 6813, 3936, 7082, 6181, 1101, 6601, 8820, 7111, 5468, 5035, 10868, 814, 2142, 4047, 10763, 4178, 6736, 4212, 9404, 4590, 4873, 9380, 6305, 8983, 10026, 10383, 6909, 2242, 7425, 2472, 11276, 3028, 12117, 2686, 11609, 4293, 9807, 3627, 11703, 2059, 3915, 1167, 9687, 4752, 2528, 12051, 7968, 10526, 34, 6, 10170, 4537, 9362, 866, 6923, 3511, 1251, 11471, 11285, 850, 4305, 10901, 8649, 1357, 4519, 4946, 8093, 8981, 336, 3130, 205, 3391, 1001, 3897, 9414, 10847, 5286, 223, 1318, 10803, 10096, 7826, 2977, 3250, 1327, 1136, 5972, 2031, 6734, 8408, 8690, 3606, 5214, 2441, 2202, 5522, 11026, 10186, 12281, 4831, 9457, 11890, 2681, 10046, 9448, 5547, 9004, 5376, 11565, 11909, 6586, 8453, 11679, 2206, 948, 6517, 3913, 10716, 10467, 10054, 6695, 1236, 2582, 7333, 8720, 2392, 11235, 10423, 11749, 10751, 9112, 9973, 2681, 5303, 11922, 10682, 5525, 5640, 1343, 5393, 1492, 7799, 4252, 394, 4779, 4943, 7712, 397, 9128, 9894, 6807, 1467, 10667, 10202, 11269, 1977, 854, 5732, 4543, 1384, 6970, 7419, 2806, 6020, 11379, 8013, 11926, 11961, 4522, 8349, 10528, 1602, 11240, 12213, 9784, 7211, 10664, 10544, 5280, 2221, 9936, 4452, 8638, 11646, 2116, 3503, 4175, 1413, 1841, 7149, 6327, 3000, 7746, 4438, 991, 10629, 11288, 2368, 9443, 4951, 10971, 8152, 1816, 9593, 1107, 11963, 897, 7620, 1012, 7159, 11690, 8917, 11075, 2779, 10435, 7692, 2262, 4162, 8478, 6856, 10654, 6092, 526, 316, 3422, 11777, 1637, 4366, 4753, 914, 5852, 2799, 5896, 8414, 7129, 9166, 11252, 7529, 3642, 1955, 12184, 4170]
        g = [11064, 8934, 5616, 359, 7580, 9725, 1031, 7989, 478, 7921, 888, 11077, 1664, 9541, 1130, 8739, 1168, 2830, 667, 5658, 5037, 6986, 6470, 12150, 12191, 10971, 8628, 875, 3919, 8820, 8272, 1201, 10483, 9753, 1890, 1435, 9014, 6106, 3366, 9948, 3596, 9916, 6993, 6204, 2938, 9652, 9090, 3129, 11795, 758, 10210, 11407, 10226, 8409, 10830, 4253, 3074, 7902, 1648, 3672, 1209, 11575, 4832, 5795, 9750, 11883, 3981, 6260, 4297, 1100, 2225, 3648, 1962, 76, 2944, 6767, 3370, 11562, 906, 10687, 1682, 1392, 1527, 6526, 1646, 7337, 4523, 3014, 6576, 8425, 9613, 7432, 7505, 3054, 2179, 5425, 1385, 3324, 7703, 3796, 2837, 424, 1406, 11897, 5839, 4815, 3529, 10310, 4968, 9016, 12116, 8906, 11878, 520, 701, 7278, 429, 7653, 7638, 2308, 11246, 4924, 4045, 11002, 3008, 6127, 10189, 1678, 3427, 9307, 4124, 8646, 12062, 1152, 4503, 7489, 12053, 5764, 3901, 11449, 695, 1554, 10489, 5831, 11562, 8406, 10257, 6309, 9958, 7637, 11958, 11554, 9209, 3866, 7193, 9901, 11854, 2547, 2532, 11738, 8096, 7950, 11116, 9066, 2161, 9380, 8004, 6419, 7630, 9813, 3580, 536, 9358, 7746, 8584, 2468, 11878, 2224, 3931, 8886, 11088, 6071, 408, 168, 1584, 2145, 722, 4134, 2460, 2379, 11548, 11022, 6859, 2713, 1644, 10503, 10179, 5689, 5981, 1942, 6198, 4958, 314, 3596, 6629, 6034, 1835, 11994, 480, 8167, 6819, 5170, 3766, 4454, 4203, 8070, 9748, 6, 1312, 5118, 1002, 4505, 342, 7492, 1177, 9904, 4297, 7691, 8367, 4063, 6249, 1112, 7523, 853, 10392, 5384, 9505, 9723, 10343, 5294, 5318, 10295, 2338, 7879, 5184, 1229, 3687, 8162, 2146, 2674, 7781, 4138, 1661, 9808, 4502, 511, 5753, 816, 7735, 10356, 1726, 3360, 9918, 12010, 37, 4252, 11537, 6635, 11676, 8874, 2447, 4770, 9151, 6332, 533, 7243, 8191, 2340, 225, 9804, 4999, 10449, 4478, 8695, 8792, 6852, 9849, 3060, 5974, 11417, 5430, 4545, 8217, 3378, 6352, 9575, 507, 1979, 5111, 8118, 3115, 8512, 2193, 5473, 9266, 10961, 5210, 7350, 5355, 10938, 11313, 6246, 11336, 8195, 6148, 9810, 7215, 1870, 10729, 10171, 8980, 6619, 11795, 9020, 1120, 9267, 5225, 302, 4024, 1106, 947, 8452, 2849, 5225, 5550, 6555, 6648, 10764, 8122, 3076, 3510, 7820, 3406, 1170, 9321, 677, 10020, 2053, 6929, 1505, 9208, 8402, 6591, 11582, 3316, 7783, 11698, 3315, 3906, 11850, 425, 6661, 7247, 10015, 5936, 163, 1092, 5405, 3095, 9752, 10793, 6846, 7967, 4703, 8059, 3567, 7522, 8994, 3207, 5353, 4882, 5026, 9819, 11252, 11213, 5740, 6722, 8698, 4554, 3381, 8566, 5611, 747, 1774, 546, 2869, 9362, 124, 11463, 3768, 7213, 1578, 2951, 5122, 4955, 3850, 2571, 5444, 5614, 10854, 9275, 4839, 11873, 607, 2507, 1484, 1685, 11042, 2202, 4102, 4785, 291, 8001, 550, 1073, 1694, 7202, 5793, 11605, 6319, 4812, 8258, 6375, 9003, 6903, 709, 2939, 7766, 10794, 5661, 1700, 4516, 10421, 5812, 11224, 5386, 6097, 6711, 5808, 12224, 3515, 8590, 12090, 7728, 1305, 8467, 9176, 10446, 11960, 7060, 7707, 8308, 5859, 6211, 9162, 8999, 640, 4441, 2790, 6754, 6324, 550, 2825, 6265, 4068, 9453, 4510, 1270, 9595, 7135, 10216, 6599, 8113, 8281, 2500, 4937, 4779, 6721, 5155, 1130, 4524, 810, 3572, 3391, 1660, 7121, 6511, 1627, 9789, 10291, 932, 2257, 10271, 9430, 10994, 5097, 12021, 9137, 10098, 7795, 3869, 3523,
             9189, 8347, 967, 1115, 11622, 11977, 3840, 8997, 1395, 7438, 190, 10589, 11155, 864, 3143, 1810, 94, 11064, 10624, 10165, 10160, 2158, 5379, 1799, 5694, 7338, 8681, 3064, 1729, 5211, 6767, 8336, 5600, 9493, 12066, 8229, 6860, 6600, 8112, 8492, 2918, 8499, 8116, 7521, 4173, 1607, 725, 7467, 6842, 10258, 1537, 2821, 112, 11050, 449, 10668, 10586, 3278, 10025, 2795, 8857, 733, 5771, 1797, 10930, 11631, 9988, 9751, 7347, 1632, 3759, 3469, 6990, 6031, 1486, 8586, 3932, 5737, 10726, 5047, 3016, 3939, 2257, 73, 918, 1098, 5668, 4513, 11115, 1589, 5752, 8063, 6845, 10603, 6639, 5217, 4067, 6009, 6182, 5141, 970, 9835, 1626, 4576, 340, 3785, 11058, 11330, 1869, 3314, 10046, 11851, 2794, 10911, 6226, 4701, 5365, 11449, 89, 8992, 5713, 6744, 6506, 1411, 4495, 5128, 8368, 11155, 642, 2762, 2273, 8696, 2513, 287, 4384, 7155, 2209, 3577, 12076, 10996, 5115, 5909, 1031, 4205, 11850, 1647, 9055, 532, 10815, 7834, 826, 3968, 3307, 6726, 6179, 10166, 10036, 1966, 859, 9893, 4937, 61, 8851, 9770, 8514, 10958, 6840, 4218, 2502, 5148, 9480, 7101, 7478, 9896, 1471, 8894, 2966, 7446, 8045, 7191, 3709, 11381, 738, 4058, 2990, 9358, 2916, 6789, 8679, 2047, 2110, 6100, 7556, 11044, 6851, 8970, 6211, 4159, 3937, 1644, 3865, 2995, 2719, 2400, 3170, 2984, 1530, 12081, 8011, 982, 8497, 5635, 658, 7925, 5992, 10392, 897, 2765, 10776, 9532, 8217, 2367, 742, 10219, 8271, 4808, 8106, 3078, 1207, 10820, 3627, 5821, 1934, 9906, 5231, 9769, 7073, 5, 10088, 11574, 7410, 8109, 1393, 244, 7688, 1312, 1683, 9091, 11072, 8662, 7609, 10904, 6663, 5089, 10293, 5999, 6911, 417, 305, 6857, 1637, 9006, 11998, 288, 893, 3057, 585, 9224, 4446, 5658, 7089, 7072, 5906, 11779, 1049, 6779, 2875, 4755, 9190, 5325, 1664, 11986, 11092, 8864, 9374, 9103, 7918, 2108, 7978, 10455, 581, 2410, 11019, 6598, 4002, 2425, 2485, 6084, 5204, 10008, 10269, 9286, 4542, 7167, 9626, 11127, 10200, 10059, 10306, 6663, 937, 11217, 5560, 5416, 3880, 7375, 10422, 7691, 2890, 8827, 9682, 9155, 6862, 9040, 1378, 3031, 10033, 594, 74, 3643, 10197, 1709, 11131, 5971, 6578, 9606, 246, 10998, 7184, 7898, 10764, 8250, 375, 7883, 7732, 1218, 11854, 9646, 7850, 8830, 10257, 7145, 5383, 9796, 5493, 2347, 1344, 1857, 1940, 874, 8884, 1936, 5097, 9124, 4726, 6201, 8870, 5822, 1724, 6705, 2032, 9163, 5634, 6714, 663, 8490, 10683, 478, 7572, 2399, 1604, 7345, 7275, 7782, 225, 1667, 2549, 5143, 842, 3351, 3036, 1218, 5166, 10754, 6036, 9934, 9050, 2510, 10375, 11841, 3653, 3322, 11990, 5034, 1419, 1936, 2248, 4735, 11361, 12140, 9463, 5161, 8560, 5568, 11830, 6916, 1872, 11948, 4037, 10771, 2921, 6003, 9179, 4941, 2758, 2083, 7967, 9161, 10868, 10569, 8560, 10381, 8165, 6554, 9539, 2859, 10138, 7646, 5057, 3199, 520, 306, 10139, 5320, 4469, 1872, 8155, 11394, 7619, 6924, 5207, 7239, 2116, 2457, 10105, 2101, 4333, 7486, 7825, 8259, 1613, 2518, 1466, 6513, 2748, 6549, 9910, 1116, 1756, 762, 1017, 10025, 2630, 4167, 9731, 8082, 12122, 9272, 4983, 10161, 1216, 10309, 1717, 1037, 5388, 4451, 3796, 4631, 10814, 11781, 2514, 1750, 6736, 11785, 281, 1961, 7647, 5453, 7865, 3509, 3695, 10501, 3132, 8617, 1030, 9440, 6088, 8513, 12165, 11734, 7236, 7402]

    file.write("# q = {}\n".format(q))
    file.write("f[{}] = {}\n".format(q, f))
    file.write("g[{}] = {}\n".format(q, g))
    T = NTT(q)
    f_ntt = T.ntt(f)
    g_ntt = T.ntt(g)
    file.write("f_ntt[{}] = {}\n".format(q, f_ntt))
    file.write("g_ntt[{}] = {}\n".format(q, g_ntt))
    f_ntt_mul_g_ntt = T.mul_ntt(f_ntt, g_ntt)
    file.write("f_ntt_mul_g_ntt[{}] = {}\n".format(q, f_ntt_mul_g_ntt))
    f_mul_g = T.intt(f_ntt_mul_g_ntt)
    assert f_mul_g == (Poly(f, q) * Poly(g, q)).coeffs
    file.write("f_mul_g[{}] = {}\n\n".format(q, f_mul_g))

file.close()
